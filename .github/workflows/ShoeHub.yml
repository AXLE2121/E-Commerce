  validate:
    name: üß™ Validate Project
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: üîç Check Project Structure
      run: |
        echo "üìÅ PROJECT STRUCTURE ANALYSIS"
        echo "============================="
        
        # List all HTML files
        echo ""
        echo "üìÑ HTML FILES:"
        echo "-------------"
        find . -name "*.html" -type f | sort
        
        # List all JS files
        echo ""
        echo "üìú JAVASCRIPT FILES:"
        echo "-------------------"
        find . -name "*.js" -type f | sort
        
        # List all CSS files
        echo ""
        echo "üé® CSS FILES:"
        echo "------------"
        find . -name "*.css" -type f | sort
        
    - name: ‚úÖ Validate Required Files
      run: |
        echo ""
        echo "‚úÖ CHECKING REQUIRED FILES"
        echo "=========================="
        
        # Required files based on your screenshot
        REQUIRED_FILES=(
          "index.html"
          "cart.html"
          "checkout.html"
          "login.html"
          "register.html"
          "my-orders.html"
          "order-confirmation.html"
          "order-details.html"
          "reset-password.html"
          "verify-email.html"
          "viewProduct.html"
          "test-direction.html"
        )
        
        ALL_GOOD=true
        
        echo ""
        echo "üìã REQUIRED FILES:"
        for file in "${REQUIRED_FILES[@]}"; do
          if [ -f "$file" ]; then
            echo "   ‚úÖ $file"
          else
            echo "   ‚ùå $file - MISSING"
            ALL_GOOD=false
          fi
        done
        
        if [ "$ALL_GOOD" = false ]; then
          echo ""
          echo "‚ùå ERROR: Some required files are missing!"
          exit 1
        fi
        
    - name: üõ†Ô∏è Validate HTML Syntax
      run: |
        echo ""
        echo "üîß HTML VALIDATION"
        echo "=================="
        
        # Check HTML files for basic structure
        HTML_ERRORS=false
        
        for html_file in *.html; do
          if [ -f "$html_file" ]; then
            echo ""
            echo "üîç Checking $html_file:"
            
            # Check for DOCTYPE
            if grep -q "<!DOCTYPE html>" "$html_file"; then
              echo "   ‚úÖ DOCTYPE present"
            else
              echo "   ‚ùå Missing DOCTYPE"
              HTML_ERRORS=true
            fi
          fi
        done
        
        if [ "$HTML_ERRORS" = true ]; then
          echo ""
          echo "‚ùå HTML validation failed!"
          exit 1
        fi
        
    - name: üìú Validate JavaScript
      run: |
        echo ""
        echo "üìú JAVASCRIPT VALIDATION"
        echo "========================"
        
        # Check JS directory exists
        if [ ! -d "js" ]; then
          echo "‚ö†Ô∏è  No 'js' directory found"
          exit 0
        fi
        
        JS_ERRORS=false
        
        for js_file in js/*.js; do
          if [ -f "$js_file" ]; then
            echo ""
            echo "üîç Checking $js_file:"
            
            # Check JavaScript syntax
            if node -c "$js_file" 2>/dev/null; then
              echo "   ‚úÖ Valid syntax"
            else
              echo "   ‚ùå Syntax error"
              node -c "$js_file" 2>&1 | head -2
              JS_ERRORS=true
            fi
          fi
        done
        
        if [ "$JS_ERRORS" = true ]; then
          echo ""
          echo "‚ùå JavaScript validation failed!"
          exit 1
        fi
        
    - name: üîó Check Links and Resources
      run: |
        echo ""
        echo "üîó LINK VALIDATION"
        echo "=================="
        
        echo "Checking for broken image references..."
        echo "Found these image references:"
        grep -r "\.\(jpg\|jpeg\|png\|gif\|svg\)" --include="*.html" --include="*.js" --include="*.css" . | head -10
        
    - name: üîí Security Check
      run: |
        echo ""
        echo "üîí SECURITY CHECK"
        echo "================="
        
        echo "Checking for exposed Firebase configuration..."
        
        # Check for hardcoded Firebase config
        if grep -r "apiKey.*:.*['\"]" --include="*.js" --include="*.html" . | grep -v "test\|example\|dummy" | head -2; then
          echo ""
          echo "‚ö†Ô∏è  WARNING: Potential API keys found in code"
        else
          echo "‚úÖ No exposed API keys found"
        fi
        
    - name: üß™ Run Basic Tests
      run: |
        echo "üß™ Running basic tests..."
        echo "========================"
        
        # Simple file existence checks
        ESSENTIAL_FILES=("index.html" "js/order-confirmation.js" "styles/style.css")
        all_good=true
        
        for file in "${ESSENTIAL_FILES[@]}"; do
          if [ -f "$file" ]; then
            echo "‚úÖ $file exists"
          else
            echo "‚ùå $file is missing"
            all_good=false
          fi
        done
        
        # Count HTML files
        HTML_COUNT=$(find . -name "*.html" -type f | wc -l)
        echo "üìÑ Found $HTML_COUNT HTML files"
        
        # Count JS files
        JS_COUNT=$(find . -name "*.js" -type f | wc -l)
        echo "üìú Found $JS_COUNT JS files"
        
        if [ "$all_good" = true ]; then
          echo "üéâ All basic tests passed!"
        else
          echo "‚ùå Some tests failed!"
          exit 1
        fi
        
    - name: üìä Generate Validation Report
      run: |
        echo ""
        echo "üìä VALIDATION REPORT"
        echo "===================="
        
        # Count files
        HTML_COUNT=$(find . -name "*.html" -type f | wc -l)
        JS_COUNT=$(find . -name "*.js" -type f | wc -l)
        CSS_COUNT=$(find . -name "*.css" -type f | wc -l)
        
        echo "üìÅ File Counts:"
        echo "   HTML: $HTML_COUNT files"
        echo "   JavaScript: $JS_COUNT files"
        echo "   CSS: $CSS_COUNT files"
        echo ""
        echo "‚úÖ Validation completed successfully!"