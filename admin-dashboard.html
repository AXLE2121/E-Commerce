<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Add Products</title>
    <link rel="stylesheet" href="styles/style.css">
    <style>
        .admin-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
        }
        .admin-form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .admin-btn {
            background: #d50000;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        .admin-btn.secondary {
            background: #666;
        }
        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .product-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .product-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        .product-info {
            padding: 15px;
        }
        .product-actions {
            padding: 10px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <h1>Admin Dashboard - Product Management</h1>
        
        <div class="admin-form">
            <h2>Add New Product</h2>
            <form id="addProductForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Product Name</label>
                        <input type="text" class="form-control" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label>Brand</label>
                        <select class="form-control" id="productBrand" required>
                            <option value="">Select Brand</option>
                            <option value="NIKE">NIKE</option>
                            <option value="ADIDAS">ADIDAS</option>
                            <option value="PUMA">PUMA</option>
                            <option value="NEW BALANCE">NEW BALANCE</option>
                            <option value="CONVERSE">CONVERSE</option>
                            <option value="VANS">VANS</option>
                            <option value="REEBOK">REEBOK</option>
                            <option value="ASICS">ASICS</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Price ($)</label>
                        <input type="number" class="form-control" id="productPrice" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select class="form-control" id="productCategory" required>
                            <option value="">Select Category</option>
                            <option value="Basketball">Basketball</option>
                            <option value="Running">Running</option>
                            <option value="Lifestyle">Lifestyle</option>
                            <option value="Casual">Casual</option>
                            <option value="Skateboarding">Skateboarding</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="form-control" id="productDescription" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Image URL</label>
                    <input type="url" class="form-control" id="productImage" placeholder="https://example.com/image.jpg" required>
                </div>
                
                <button type="submit" class="admin-btn">Add Product</button>
                <button type="button" class="admin-btn secondary" onclick="addSampleProducts()">Add Sample Products</button>
            </form>
        </div>
        
        <h2>Existing Products</h2>
        <div id="productList" class="product-list">
            <!-- Products will be loaded here -->
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    
    <script>
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyCn721TvxMu3R6JX5fpYTXemZPB6alHQX0",
            authDomain: "shoehub-711f9.firebaseapp.com",
            projectId: "shoehub-711f9",
            storageBucket: "shoehub-711f9.firebasestorage.app",
            messagingSenderId: "719905522600",
            appId: "1:719905522600:web:3ad4f4c2213b25a9a5d39d"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Load existing products
        async function loadProducts() {
            try {
                const snapshot = await db.collection('products').get();
                const productList = document.getElementById('productList');
                productList.innerHTML = '';
                
                if (snapshot.empty) {
                    productList.innerHTML = '<p>No products found.</p>';
                    return;
                }
                
                snapshot.docs.forEach(doc => {
                    const product = doc.data();
                    const productCard = `
                        <div class="product-card">
                            <img src="${product.image}" alt="${product.name}">
                            <div class="product-info">
                                <h4>${product.brand}</h4>
                                <p><strong>${product.name}</strong></p>
                                <p>$${product.price}</p>
                                <p><small>${product.category} â€¢ ${product.gender}</small></p>
                            </div>
                            <div class="product-actions">
                                <button onclick="editProduct('${doc.id}')">Edit</button>
                                <button onclick="deleteProduct('${doc.id}')" style="color: red;">Delete</button>
                            </div>
                        </div>
                    `;
                    productList.insertAdjacentHTML('beforeend', productCard);
                });
                
            } catch (error) {
                console.error('Error loading products:', error);
                alert('Error loading products: ' + error.message);
            }
        }

        // Add product form handler
        document.getElementById('addProductForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const productData = {
                brand: document.getElementById('productBrand').value,
                name: document.getElementById('productName').value,
                price: parseFloat(document.getElementById('productPrice').value),
                description: document.getElementById('productDescription').value,
                category: document.getElementById('productCategory').value,
                gender: "Unisex",
                image: document.getElementById('productImage').value,
                sizes: ["7", "8", "9", "10", "11"],
                colors: ["Black", "White"],
                stock: 50,
                rating: 4.5,
                reviews: 0,
                featured: false,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                const docRef = await db.collection('products').add(productData);
                console.log('Product added with ID:', docRef.id);
                alert('Product added successfully!');
                document.getElementById('addProductForm').reset();
                loadProducts();
            } catch (error) {
                console.error('Error adding product:', error);
                alert('Error adding product: ' + error.message);
            }
        });

        // Add sample products function
        async function addSampleProducts() {
            const sampleProducts = [
                {
                    brand: "NIKE",
                    name: "Dunk Low Retro",
                    price: 110,
                    description: "Classic skate-inspired shoes with padded collar",
                    gender: "Unisex",
                    category: "Lifestyle",
                    image: "https://images.unsplash.com/photo-1600269452121-4f2416e55c28?w=400&h=300&fit=crop",
                    sizes: ["7", "8", "9", "10", "11", "12"],
                    colors: ["Black/White", "University Red", "Panda"],
                    stock: 40,
                    rating: 4.6,
                    reviews: 89,
                    featured: true
                },
                {
                    brand: "ADIDAS",
                    name: "NMD_R1",
                    price: 140,
                    description: "Modern running-inspired lifestyle shoes",
                    gender: "Men",
                    category: "Lifestyle",
                    image: "https://images.unsplash.com/photo-1512374382149-233c42b6a83b?w=400&h=300&fit=crop",
                    sizes: ["8", "9", "10", "11", "12"],
                    colors: ["Core Black", "White", "Grey"],
                    stock: 35,
                    rating: 4.4,
                    reviews: 67,
                    featured: false
                }
            ];
            
            try {
                const batch = db.batch();
                
                sampleProducts.forEach(product => {
                    const productRef = db.collection('products').doc();
                    batch.set(productRef, {
                        ...product,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                });
                
                await batch.commit();
                alert('Sample products added successfully!');
                loadProducts();
                
            } catch (error) {
                console.error('Error adding sample products:', error);
                alert('Error: ' + error.message);
            }
        }

        // Delete product
        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;
            
            try {
                await db.collection('products').doc(productId).delete();
                alert('Product deleted successfully!');
                loadProducts();
            } catch (error) {
                console.error('Error deleting product:', error);
                alert('Error: ' + error.message);
            }
        }

        // Edit product (placeholder)
        function editProduct(productId) {
            alert('Edit feature coming soon! Product ID: ' + productId);
            // You can implement edit functionality here
        }

        // Load products on page load
        loadProducts();
    </script>
</body>
</html>